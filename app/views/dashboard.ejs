<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'/>
    <link rel="stylesheet" href="/css/main.css"/>
    <title>Quizzone - Dashboard</title>
</head>
<body>
<div class="ovl-app">
<%- include('components/left-sidebar'); -%>
<div class="cat-cnt">

</div>
</div>

    <script>
        if((localStorage.getItem('jwt-token')==null)||localStorage.getItem('jwt-token')==''){
            window.location.href='/login';
        }
        
        document.addEventListener('DOMContentLoaded', async function() {
            if(localStorage.getItem('status')!==""||localStorage.getItem('status')!==null){
                document.querySelector('#gc1').innerHTML+=localStorage.getItem('status');
                localStorage.setItem('status','');
            }
            const token = localStorage.getItem('jwt-token');
            try {
                const response = await fetch('http://quizzone.zapto.org:8000/api/user', {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    }
                });
    
                if (!response.ok) {
                    throw new Error('Failed to fetch quizzes');
                }
                
                const data = await response.json();
                const quizList = document.getElementById('quizList');
                quizList.innerHTML=data.username;

            } catch (error) {
                console.error('Error fetching quizzes:', error);
                const quizList = document.getElementById('quizList');
                quizList.innerHTML = '<li class="text-danger">Wystąpił błąd podczas pobierania quizów.</li>'; 
            }

            
        });

document.addEventListener('click',(event)=> {
    if(event.target.classList.contains('sidebar-user-logout')||event.target.classList.contains('bx-log-out')){
            localStorage.setItem('jwt-token','');
            console.log('Wylogowano..');
            window.location.href='/login';
    }
});        


    </script>
    
</body>
</html>